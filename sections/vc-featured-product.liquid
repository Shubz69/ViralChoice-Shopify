{% comment %}
  ViralChoice Featured Product Section
  Displays a featured product card
{% endcomment %}

{% assign featured_product = section.settings.product %}
{% if featured_product == blank %}
  {% assign featured_product = collections.all.products.first %}
{% endif %}

{% if featured_product %}
  <section class="vc-featured-product vc-reveal">
    <div class="vc-section-background"></div>
    <div class="vc-featured-product__inner">
      {% if section.settings.title != blank %}
        <h2 class="vc-featured-product__title">{{ section.settings.title }}</h2>
      {% else %}
        <h2 class="vc-featured-product__title">Featured Product</h2>
      {% endif %}
      
      <a href="{{ featured_product.url }}" class="vc-featured-product-card">
          {% if featured_product.featured_image %}
            <img 
              src="{{ featured_product.featured_image | image_url: width: 800 }}"
              srcset="{{ featured_product.featured_image | image_url: width: 400 }} 400w,
                      {{ featured_product.featured_image | image_url: width: 600 }} 600w,
                      {{ featured_product.featured_image | image_url: width: 800 }} 800w,
                      {{ featured_product.featured_image | image_url: width: 1200 }} 1200w"
              sizes="(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 500px"
              alt="{{ featured_product.featured_image.alt | escape }}"
              class="vc-featured-product-card__image"
              loading="lazy"
              width="800"
              height="{{ 800 | divided_by: featured_product.featured_image.aspect_ratio | ceil }}"
            >
          {% endif %}
        
        <h3 class="vc-featured-product-card__title">{{ featured_product.title }}</h3>
        
        <div class="vc-featured-product-card__price">
          {{ featured_product.price | money }}
        </div>
        
        <span class="vc-button vc-button--primary">
          View Product
        </span>
      </a>
    </div>
  </section>
{% endif %}

{% schema %}
{
  "name": "VC Featured Product",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "Featured Product"
    },
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    }
  ],
  "presets": [
    {
      "name": "VC Featured Product"
    }
  ]
}
{% endschema %}
